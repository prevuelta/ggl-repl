<html>
	<body>
		<svg width="500" height="500" fill="none" id="test">
		</svg>
		<button onclick="generateArcs()">Generate</button>
		<script type="text/javascript">


			function getMid (p1, p2) {
			  return [(p1.x + p2.x) / 2, (p1.y + p2.y) / 2];
			}
			function getDistance (p1, p2) {
			  return getSide(p1.y - p2.y, p1.x - p2.x);
			}
			function getSide (adj, opp, hyp) {
			  if(!isNaN(adj) & !isNaN(hyp)) {
			    return Math.sqrt(hyp*hyp - adj*adj);
			  } else if(!isNaN(adj) & !isNaN(opp)) {
			    return Math.sqrt(opp*opp + adj*adj);
			  } else if(!isNaN(opp) & !isNaN(hyp)) {
			    return Math.sqrt(hyp*hyp - opp*opp);
			  }
			  console.warn("Invalid values passed to getSide");
			}
			function getAngle (p1, p2) {
			  // var adj = getDistance(p1, {x: p2.x, y: p1.y});
			  // var hyp = getDistance(p1, p2);
			  // return (Math.PI / 2) - Math.acos( adj / hyp );
			  let angle = Math.atan2(p1.y - p2.y, p1.x - p2.x);
			  return angle;


			}
			function radToDeg (radians) {
			  return radians / (Math.PI / 180)
			}
			function degToRad (degrees) {
			  return degrees * (Math.PI / 180);
			}

			function polarToCartesian(center, radius, angle) {
			    return {
			      x: center.x + Math.cos(angle) * radius,
			      y: center.y + Math.sin(angle) * radius
			    };
			}

			const { PI } = Math;
			const HALF_PI = PI / 2;
			const TWO_PI = PI * 2;

			var colors = ['red', 'blue', 'pink', 'green'];


			var svg = document.getElementById('test')

			for (let i = 0; i < 16; i++) {
 				const angle = TWO_PI / 16 * i;
				let x = Math.cos(angle) * 45 + 100;
				let y = Math.sin(angle) * 45 + 100;
				point({ x, y }, i ? 'red': 'yellow', i ? 1 : 5)
			}

			generateArcs({ x: 145, y: 100});
			generateArcs({ x: 100, y: 55});
			generateArcs({ x: 55, y: 100})
			generateArcs({ x: 100, y: 145});


			function point(loc, color='blue', radius = 2, stroke = false) {
				var point = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
				point.setAttribute('cx', loc.x);
				point.setAttribute('cy', loc.y);
				point.setAttribute('fill', stroke ? 'none' : color);
        if (stroke) {
          point.setAttribute('stroke', color);
        }
				point.setAttribute('r', radius);
				svg.appendChild(point);

			}

			function generateArcs (center) {

				var start = { x: 100, y: 100};
				// var center = { x: 145, y: 100};

				point(start, 'red');
				point(center);
        point(center, 'brown', getDistance(start, center), true);

				var sweeps = [0, 0, 1, 0];
				var laf = [0, 1, 1, 1];

        var mul = 1.3;

				for (let i = 0; i < 2; i++) {
          var angle = i  ? Math.PI * mul : -Math.PI * mul;
					var path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
					const str = describeArc(start, center, angle, sweeps[i], laf[i]);
					path.setAttribute('d', str);
					path.setAttribute('stroke', colors[i]);
					test.appendChild(path);
				}
			}


			function describeArc(start, center, angle, sweep, largArcFlag) {

          const originalAngle = angle;
          const startAngle = getAngle(start, center);
			    angle += startAngle;
			    angle = angle % (Math.PI * 2);
			    console.log("Post angle", radToDeg(angle));

          if (originalAngle > PI || originalAngle < -PI) {
            sweep = 1;
          }


			    if (angle >= Math.PI) {
			    	largArcFlag = 1;
			    }

			    const radius = getDistance(start, center);
			    var end = polarToCartesian(center, radius, angle);
			    point(end, 'black')

				return `M ${start.x} ${start.y} A ${radius} ${radius} 0 ${sweep} ${largArcFlag} ${end.x} ${end.y}`;
			}

		</script>
	</body>
</html>
